<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Approximately optimal survey scheme — approx_optimal_survey_scheme • surveyvoi</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Approximately optimal survey scheme — approx_optimal_survey_scheme" />
<meta property="og:description" content="Find the optimal survey scheme that maximizes return on investment using
value of information analyses. This function uses the approximation method
for calculating the expected value of the decision given a survey scheme." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">surveyvoi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/approximation.html">Approximation Benchmark</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Simulation Study</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jeffreyhanson/surveyvoi/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Approximately optimal survey scheme</h1>
    <small class="dont-index">Source: <a href='https://github.com/jeffreyhanson/surveyvoi/blob/master/R/approx_optimal_survey_scheme.R'><code>R/approx_optimal_survey_scheme.R</code></a></small>
    <div class="hidden name"><code>approx_optimal_survey_scheme.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Find the optimal survey scheme that maximizes return on investment using
value of information analyses. This function uses the approximation method
for calculating the expected value of the decision given a survey scheme.</p>
    </div>

    <pre class="usage"><span class='fu'>approx_optimal_survey_scheme</span>(
  <span class='no'>site_data</span>,
  <span class='no'>feature_data</span>,
  <span class='no'>site_occupancy_columns</span>,
  <span class='no'>site_probability_columns</span>,
  <span class='no'>site_env_vars_columns</span>,
  <span class='no'>site_management_cost_column</span>,
  <span class='no'>site_survey_cost_column</span>,
  <span class='no'>feature_survey_column</span>,
  <span class='no'>feature_survey_sensitivity_column</span>,
  <span class='no'>feature_survey_specificity_column</span>,
  <span class='no'>feature_model_sensitivity_column</span>,
  <span class='no'>feature_model_specificity_column</span>,
  <span class='no'>feature_preweight_column</span>,
  <span class='no'>feature_postweight_column</span>,
  <span class='no'>feature_target_column</span>,
  <span class='no'>total_budget</span>,
  <span class='no'>survey_budget</span>,
  <span class='no'>xgb_parameters</span>,
  <span class='kw'>site_management_locked_in_column</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>site_survey_locked_out_column</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>prior_matrix</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>optimality_gap</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>site_weight_columns</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>xgb_n_folds</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>5</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>feature_data</span>)),
  <span class='kw'>n_approx_replicates</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>n_approx_outcomes_per_replicate</span> <span class='kw'>=</span> <span class='fl'>10000</span>,
  <span class='kw'>method_approx_outcomes</span> <span class='kw'>=</span> <span class='st'>"weighted_without_replacement"</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>500</span>,
  <span class='kw'>n_threads</span> <span class='kw'>=</span> <span class='fl'>1</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>site_data</th>
      <td><p><code><a href='https://rdrr.io/pkg/sf/man/sf.html'>sf</a></code> object with site data.</p></td>
    </tr>
    <tr>
      <th>feature_data</th>
      <td><p><code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></code> object with feature data.</p></td>
    </tr>
    <tr>
      <th>site_occupancy_columns</th>
      <td><p><code>character</code> names of <code>numeric</code>
columns in the
argument to <code>site_data</code> that contain presence/absence data.
Each column should correspond to a different feature, and contain
binary presence/absence data (zeros or ones) indicating if the
feature was detected in a previous survey or not. If a site has not
been surveyed before, then missing (<code>NA</code>) values should be used.</p></td>
    </tr>
    <tr>
      <th>site_probability_columns</th>
      <td><p><code>character</code> names of <code>numeric</code>
columns in the argument to <code>site_data</code> that contain modelled
probabilities of occupancy for each feature in each site.
Each column should correspond to a different feature, and contain
probability data (values between zero and one). No missing (<code>NA</code>)
values are permitted in these columns.</p></td>
    </tr>
    <tr>
      <th>site_env_vars_columns</th>
      <td><p><code>character</code> names of columns in the
argument to  <code>site_data</code> that contain environmental information
for fitting updated occupancy models based on possible survey outcomes.
Each column should correspond to a different environmental variable,
and contain <code>numeric</code>, <code>factor</code>, or <code>character</code> data.
No missing (<code>NA</code>) values are permitted in these columns.</p></td>
    </tr>
    <tr>
      <th>site_management_cost_column</th>
      <td><p><code>character</code> name of column in the
argument to <code>site_data</code> that contains costs for managing each
site for conservation. This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p></td>
    </tr>
    <tr>
      <th>site_survey_cost_column</th>
      <td><p><code>character</code> name of column in the
argument to  <code>site_data</code> that contains costs for surveying each
site. This column should have <code>numeric</code> values that are equal to
or greater than zero. No missing (<code>NA</code>) values are permitted in this
column.</p></td>
    </tr>
    <tr>
      <th>feature_survey_column</th>
      <td><p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains <code>logical</code> (<code>TRUE</code> /
<code>FALSE</code>) values indicating if the feature will be surveyed in
the planned surveys or not. Note that considering additional features will
rapidly increase computational burden, and so it is only recommended to
consider features that are of specific conservation interest.
No missing (<code>NA</code>) values are permitted in this column.</p></td>
    </tr>
    <tr>
      <th>feature_survey_sensitivity_column</th>
      <td><p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting a presence of each
feature in a given site (i.e. the sensitivity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p></td>
    </tr>
    <tr>
      <th>feature_survey_specificity_column</th>
      <td><p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of future surveys correctly detecting an absence of each
feature in a given site (i.e. the specificity of the survey methodology).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.</p></td>
    </tr>
    <tr>
      <th>feature_model_sensitivity_column</th>
      <td><p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting a presence of each
feature in a given site (i.e. the sensitivity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using <code><a href='fit_occupancy_models.html'>fit_occupancy_models</a></code>.</p></td>
    </tr>
    <tr>
      <th>feature_model_specificity_column</th>
      <td><p><code>character</code> name of the
column in the argument to <code>feature_data</code> that contains
probability of the initial models correctly predicting an absence of each
feature in a given site (i.e. the specificity of the models).
This column should have <code>numeric</code> values that are between zero and
one. No missing (<code>NA</code>) values are permitted in this column.
This should ideally be calculated using <code><a href='fit_occupancy_models.html'>fit_occupancy_models</a></code>.</p></td>
    </tr>
    <tr>
      <th>feature_preweight_column</th>
      <td><p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains the \(preweight\)
values used to parametrize  the conservation benefit of managing of each
feature.
This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p></td>
    </tr>
    <tr>
      <th>feature_postweight_column</th>
      <td><p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains the \(postweight\)
values used to parametrize  the conservation benefit of managing of each
feature.
This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p></td>
    </tr>
    <tr>
      <th>feature_target_column</th>
      <td><p><code>character</code> name of the column in the
argument to <code>feature_data</code> that contains the \(target\)
values used to parametrize the conservation benefit of managing of each
feature.
This column should have <code>numeric</code> values that
are equal to or greater than zero. No missing (<code>NA</code>) values are
permitted in this column.</p></td>
    </tr>
    <tr>
      <th>total_budget</th>
      <td><p><code>numeric</code> maximum expenditure permitted
for conducting surveys and managing sites for conservation.</p></td>
    </tr>
    <tr>
      <th>survey_budget</th>
      <td><p><code>numeric</code> maximum expenditure permitted
for conducting surveys.</p></td>
    </tr>
    <tr>
      <th>xgb_parameters</th>
      <td><p><code>list</code> of <code>list</code> objects
containing the parameters for fitting models for each
feature. See documentation for the <code>params</code> argument in
<code><a href='https://rdrr.io/pkg/xgboost/man/xgb.train.html'>xgb.train</a></code> for available parameters. Ideally,
these parameters would be determined using the
<code><a href='fit_occupancy_models.html'>fit_occupancy_models</a></code> function. Note that arguments must
have <code>"nrounds"</code>, <code>"objective"</code>, <code>"scale_pos_weight"</code>
elements (see example below).</p></td>
    </tr>
    <tr>
      <th>site_management_locked_in_column</th>
      <td><p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked in for (<code>TRUE</code>) being managed for conservation or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites have already been earmarked for
conservation, or if some sites are already being managed for conservation.
Defaults to <code>NULL</code> such that no sites are locked in.</p></td>
    </tr>
    <tr>
      <th>site_survey_locked_out_column</th>
      <td><p><code>character</code> name of the column
in the argument to <code>site_data</code> that contains <code>logical</code>
(<code>TRUE</code> / <code>FALSE</code>) values indicating which sites should
be locked out (<code>TRUE</code>) from being selected for future surveys or
(<code>FALSE</code>) not. No missing (<code>NA</code>) values are permitted in this
column. This is useful if some sites will never be considered for future
surveys (e.g. because they are too costly to survey, or have a
low chance of containing the target species).
Defaults to <code>NULL</code> such that no sites are locked out.</p></td>
    </tr>
    <tr>
      <th>prior_matrix</th>
      <td><p><code>numeric</code> <code>matrix</code> containing
the prior probability of each feature occupying each site.
Rows correspond to features, and columns correspond to sites.
Defaults to <code>NULL</code> such that prior data is calculated automatically
using <code><a href='prior_probability_matrix.html'>prior_probability_matrix</a></code>.</p></td>
    </tr>
    <tr>
      <th>optimality_gap</th>
      <td><p><code>numeric</code> relative optimality gap for generating
conservation prioritizations. A value of zero indicates that
prioritizations must be solved to optimality. A value of 0.1 indicates
prioritizations must be within 10% of optimality. Defaults to 0.</p></td>
    </tr>
    <tr>
      <th>site_weight_columns</th>
      <td><p><code>character</code> name of columns in
<code>site_data</code> containing weights for model fitting for each
feature. These columns must contain <code>numeric</code> values greater
than or equal to zero. No missing (<code>NA</code>) values are
permitted. Defaults to <code>NULL</code> such that all data are given
equal weight when fitting models.</p></td>
    </tr>
    <tr>
      <th>xgb_n_folds</th>
      <td><p><code>integer</code> vector containing the number of
 k-fold cross-validation folds to use for fitting models and
 assessing model performance for each feature. Ideally, the number of folds
 should be exactly the same as the number used for tuning the
 model parameters (i.e. same parameter to the <code>n_folds</code>
 argument in <a href='fit_occupancy_models.html'>fit_occupancy_models</a> when generating parameters
for <code>xgb_parameters</code>).</p></td>
    </tr>
    <tr>
      <th>n_approx_replicates</th>
      <td><p><code>integer</code> number of replicates to use for
approximating the expected value calculations. Defaults to 100.</p></td>
    </tr>
    <tr>
      <th>n_approx_outcomes_per_replicate</th>
      <td><p><code>integer</code> number of outcomes to #'   use per replicate for approximation calculations. Defaults to 10000.</p></td>
    </tr>
    <tr>
      <th>method_approx_outcomes</th>
      <td><p><code>character</code> name of method that is
used to sample outcomes for approximating the expected value
calculations. Available options are:
<code>"uniform_with_replacement"</code>, <code>"uniform_without_replacement"</code>,
<code>"weighted_with_replacement"</code>, <code>"weighted_without_replacement"</code>.
Uniform sampling methods have an equal chance of returning each
state, and weighted sampling methods are more likely to return
outcomes with a higher prior probability of occurring.
Defaults to <code>"weighted_without_replacement"</code>.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p><code>integer</code> state of the random number generator for
partitioning data into folds cross-validation and fitting <span class="pkg">xgboost</span>
models. It is also used for generating outcomes.
This parameter must remain the same to compare results from different
functions using the approximation methods. Defaults to 500.</p></td>
    </tr>
    <tr>
      <th>n_threads</th>
      <td><p><code>integer</code> number of threads to use for computation.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>matrix</code> of <code>logical</code> (<code>TRUE</code>/ <code>FALSE</code>)
values indicating if a site is selected in the scheme or not. Columns
correspond to sites, and rows correspond to different schemes. If
there is only one optimal survey scheme then the <code>matrix</code> will only
contain a single row.</p>
<p>This matrix also has a <code>numeric</code> <code>"ev"</code>
attribute that contains a matrix with the approximate expected values.
Within this attribute, each row corresponds to a different survey scheme
and each column corresponds to a different replicate.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The "approximately" optimal survey scheme is determined using a brute-force
algorithm.
Initially, all feasible (valid) survey schemes are identified given the
survey costs and the survey budget (using
<code><a href='feasible_survey_schemes.html'>feasible_survey_schemes</a></code>. Next, the expected value of each and
every feasible survey scheme is approximated
(using <code><a href='approx_evdsi.html'>approx_evdsi</a></code>).
Finally, the greatest expected value is identified, and all survey schemes
that share this greatest expected value are returned. Due to the nature of
this algorithm, it can take a very long time to complete.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># set seeds for reproducibility</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>RandomFields</span>)
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='fu'><a href='https://rdrr.io/pkg/RandomFields/man/RFoptions.html'>RFoptions</a></span>(<span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>201</span>)

<span class='co'># simulate data</span>
<span class='no'>site_data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='simulate_site_data.html'>simulate_site_data</a></span>(<span class='kw'>n_sites</span> <span class='kw'>=</span> <span class='fl'>11</span>, <span class='kw'>n_features</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>prop</span> <span class='kw'>=</span> <span class='fl'>0.8</span>)</div><div class='output co'>#&gt; ...</div><div class='input'><span class='no'>feature_data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='simulate_feature_data.html'>simulate_feature_data</a></span>(<span class='kw'>n_features</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>prop</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='co'># preview simulated data</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>site_data</span>)</div><div class='output co'>#&gt; Simple feature collection with 11 features and 9 fields
#&gt; geometry type:  POINT
#&gt; dimension:      XY
#&gt; bbox:           xmin: 0.0455565 ymin: 0.04205953 xmax: 0.9568333 ymax: 0.9545036
#&gt; CRS:            NA
#&gt; <span style='color: #555555;'># A tibble: 11 x 10</span><span>
#&gt;    survey_cost management_cost      e1      e2       e3    f1    f2     p1
#&gt;          </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>           </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>    </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>  </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span>       12.2             64.6  1.01   -</span><span style='color: #BB0000;'>0.958</span><span>   0.898       0     0 0.091</span><span style='text-decoration: underline;'>4</span><span>
#&gt; </span><span style='color: #555555;'> 2</span><span>       11.8             66.6  0.320   0.074</span><span style='text-decoration: underline;'>7</span><span>  0.262      </span><span style='color: #BB0000;'>NA</span><span>    </span><span style='color: #BB0000;'>NA</span><span> 0.491 
#&gt; </span><span style='color: #555555;'> 3</span><span>       11.1             64.4  0.924  -</span><span style='color: #BB0000;'>0.544</span><span>   1.10       </span><span style='color: #BB0000;'>NA</span><span>    </span><span style='color: #BB0000;'>NA</span><span> 0.239 
#&gt; </span><span style='color: #555555;'> 4</span><span>       10.4             78.1 -</span><span style='color: #BB0000;'>2.10</span><span>   -</span><span style='color: #BB0000;'>0.296</span><span>  -</span><span style='color: #BB0000;'>1.60</span><span>       </span><span style='color: #BB0000;'>NA</span><span>    </span><span style='color: #BB0000;'>NA</span><span> 0.676 
#&gt; </span><span style='color: #555555;'> 5</span><span>        7.27            65.4  0.177   1.24   -</span><span style='color: #BB0000;'>0.326</span><span>      </span><span style='color: #BB0000;'>NA</span><span>    </span><span style='color: #BB0000;'>NA</span><span> 0.848 
#&gt; </span><span style='color: #555555;'> 6</span><span>       11.4             72.5  1.20   -</span><span style='color: #BB0000;'>1.35</span><span>    0.003</span><span style='text-decoration: underline;'>43</span><span>    </span><span style='color: #BB0000;'>NA</span><span>    </span><span style='color: #BB0000;'>NA</span><span> 0.013</span><span style='text-decoration: underline;'>2</span><span>
#&gt; </span><span style='color: #555555;'> 7</span><span>       10.5             73.8 -</span><span style='color: #BB0000;'>0.924</span><span>  -</span><span style='color: #BB0000;'>0.643</span><span>  -</span><span style='color: #BB0000;'>1.63</span><span>       </span><span style='color: #BB0000;'>NA</span><span>    </span><span style='color: #BB0000;'>NA</span><span> 0.157 
#&gt; </span><span style='color: #555555;'> 8</span><span>        8.93            75.0 -</span><span style='color: #BB0000;'>1.08</span><span>   -</span><span style='color: #BB0000;'>0.654</span><span>  -</span><span style='color: #BB0000;'>0.659</span><span>      </span><span style='color: #BB0000;'>NA</span><span>    </span><span style='color: #BB0000;'>NA</span><span> 0.407 
#&gt; </span><span style='color: #555555;'> 9</span><span>        8.14            71.4  0.014</span><span style='text-decoration: underline;'>0</span><span>  1.73    0.764       1     1 0.984 
#&gt; </span><span style='color: #555555;'>10</span><span>        9.09            72.9  0.310   1.20    1.25       </span><span style='color: #BB0000;'>NA</span><span>    </span><span style='color: #BB0000;'>NA</span><span> 0.961 
#&gt; </span><span style='color: #555555;'>11</span><span>       10.8             66.4  0.141   0.191  -</span><span style='color: #BB0000;'>0.052</span><span style='color: #BB0000;text-decoration: underline;'>1</span><span>     </span><span style='color: #BB0000;'>NA</span><span>    </span><span style='color: #BB0000;'>NA</span><span> 0.524 
#&gt; </span><span style='color: #555555;'># ... with 2 more variables: p2 </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, geometry </span><span style='color: #555555;font-style: italic;'>&lt;POINT&gt;</span><span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>feature_data</span>)</div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 2 x 9</span><span>
#&gt;   name  survey survey_sensitiv~ survey_specific~ model_sensitivi~
#&gt;   </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;lgl&gt;</span><span>             </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>            </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>            </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'>1</span><span> f1    TRUE              0.956            0.892            0.787
#&gt; </span><span style='color: #555555;'>2</span><span> f2    TRUE              0.963            0.863            0.702
#&gt; </span><span style='color: #555555;'># ... with 4 more variables: model_specificity </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, preweight </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,</span><span>
#&gt; </span><span style='color: #555555;'>#   postweight </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, target </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span></div><div class='input'>
<span class='co'># set total budget for managing sites for conservation</span>
<span class='co'># (i.e. 50% of the cost of managing all sites)</span>
<span class='no'>total_budget</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>site_data</span>$<span class='no'>management_cost</span>) * <span class='fl'>0.5</span>

<span class='co'># set total budget for surveying sites for conservation</span>
<span class='co'># (i.e. 10% of the cost of managing all sites)</span>
<span class='no'>survey_budget</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>site_data</span>$<span class='no'>survey_cost</span>) * <span class='fl'>0.1</span>

<span class='co'># define xgboost tuning parameters</span>
<span class='no'>xgb_parameters</span> <span class='kw'>&lt;-</span>
 <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>objective</span> <span class='kw'>=</span> <span class='st'>"binary:logistic"</span>, <span class='kw'>scale_pos_weight</span> <span class='kw'>=</span> <span class='fl'>1</span>,
           <span class='kw'>nrounds</span> <span class='kw'>=</span> <span class='fl'>8</span>, <span class='kw'>eta</span> <span class='kw'>=</span> <span class='fl'>0.1</span>))[<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>)]

<span class='co'># find optimal survey scheme using approximate method</span>
<span class='co'># (using 10 replicates so that this example completes relatively quickly)</span>
<span class='no'>approx_opt_survey</span> <span class='kw'>&lt;-</span> <span class='fu'>approx_optimal_survey_scheme</span>(
  <span class='no'>site_data</span>, <span class='no'>feature_data</span>,
  <span class='fu'><a href='https://rdrr.io/pkg/RandomFields/man/QMath.html'>c</a></span>(<span class='st'>"f1"</span>, <span class='st'>"f2"</span>), <span class='fu'><a href='https://rdrr.io/pkg/RandomFields/man/QMath.html'>c</a></span>(<span class='st'>"p1"</span>, <span class='st'>"p2"</span>), <span class='fu'><a href='https://rdrr.io/pkg/RandomFields/man/QMath.html'>c</a></span>(<span class='st'>"e1"</span>, <span class='st'>"e2"</span>, <span class='st'>"e3"</span>),
  <span class='st'>"management_cost"</span>, <span class='st'>"survey_cost"</span>,
  <span class='st'>"survey"</span>, <span class='st'>"survey_sensitivity"</span>, <span class='st'>"survey_specificity"</span>,
  <span class='st'>"model_sensitivity"</span>, <span class='st'>"model_specificity"</span>,
  <span class='st'>"preweight"</span>, <span class='st'>"postweight"</span>, <span class='st'>"target"</span>,
  <span class='no'>total_budget</span>, <span class='no'>survey_budget</span>, <span class='no'>xgb_parameters</span>,
  <span class='kw'>n_approx_replicates</span> <span class='kw'>=</span> <span class='fl'>10</span>)</div><div class='output co'>#&gt; <span class='error'>Error in as(rcpp_feasible_actions_ilp_matrix(costs), "dgCMatrix"): no method or default for coercing "matrix" to "dgCMatrix"</span></div><div class='input'>
<span class='co'># print result</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>approx_opt_survey</span>)</div><div class='output co'>#&gt; <span class='error'>Error in print(approx_opt_survey): object 'approx_opt_survey' not found</span></div><div class='input'>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://jeffrey-hanson.com'>Jeffrey O Hanson</a>, <a href='https://josephrbennett.wordpress.com'>Joseph Bennett</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


